# Flatpak with Go Modules
Automatically create the source list for a Go module.

This method generates sources section with references to ZIP files hosted by the Go modules proxy.

## Usage

Example manifest (yaml):

```yaml
app-id: io.github.golang.tools.gorename
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.golang
command: gorename
modules:
  - name: gorename
    buildsystem: simple
    build-options:
      append-path: /usr/lib/sdk/golang/bin
    build-commands:
      - go install -mod=vendor ./cmd/gorename
    sources:
      - type: git
        url: https://github.com/golang/tools
        commit: e81af27852c63b9432c0b5bb49707a7f207ef21b
```

1. Install `flatpak-go-mod`: `go install github.com/dennwc/flatpak-go-mod@latest`
2. Run it in Flatpak project directory: `flatpak-go-mod ./path/to/your/go/project`
3. Append generated `go.mod.yaml` file to `sources` section of the manifest.
4. Add `modules.txt` to your Flatpak project.
5. Build/install your binary in vendor mode (with `-mod=vendor`).

## Final manifest example

```yaml
app-id: io.github.golang.tools.gorename
runtime: org.freedesktop.Platform
runtime-version: '23.08'
sdk: org.freedesktop.Sdk
sdk-extensions:
  - org.freedesktop.Sdk.Extension.golang
command: gorename
modules:
  - name: gorename
    buildsystem: simple
    build-options:
      append-path: /usr/lib/sdk/golang/bin
    build-commands:
      - go install -mod=vendor ./cmd/gorename
    sources:
      - type: git
        url: https://github.com/golang/tools
        commit: e81af27852c63b9432c0b5bb49707a7f207ef21b

      # Workaround for Go modules generated by github.com/dennwc/flatpak-go-mod
      - type: file
        path: modules.txt
        dest: vendor

      - type: archive
        url: https://proxy.golang.org/github.com/yuin/goldmark/@v/v1.4.13.zip
        strip-components: 3
        dest: vendor/github.com/yuin/goldmark
        sha256: bb41a602b174345fda392c8ad83fcc93217c285c763699677630be90feb7a5e3

      - type: archive
        url: https://proxy.golang.org/golang.org/x/mod/@v/v0.7.0.zip
        strip-components: 3
        dest: vendor/golang.org/x/mod
        sha256: 24abd1db13329873d72034dc27efad09cbc37d39cf28b8ff7bb3c2adc8eedef7

      - type: archive
        url: https://proxy.golang.org/golang.org/x/net/@v/v0.5.0.zip
        strip-components: 3
        dest: vendor/golang.org/x/net
        sha256: 0e606881eeb2f572b3d61ad2a639e79cad002064090c75c838aa2f4feca61c8e

      - type: archive
        url: https://proxy.golang.org/golang.org/x/sys/@v/v0.4.0.zip
        strip-components: 3
        dest: vendor/golang.org/x/sys
        sha256: efa9354fcaa709825bbb1c86b83e2347cebb5349f4326cc4c8ccb972ad32032c

      - type: archive
        url: https://proxy.golang.org/golang.org/x/sync/@v/v0.1.0.zip
        strip-components: 3
        dest: vendor/golang.org/x/sync
        sha256: f510bec6009e19882d19953e7273137d34df86c65949345d72f123a255c2ecd2
```